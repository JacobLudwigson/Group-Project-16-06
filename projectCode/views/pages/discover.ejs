<%- include ('../partials/head') %>
<%- include ('../partials/menu') %>
<main>
  <div class="container-fluid">
    <%-include ('../partials/message')-%>
    <%var counter = 0%>
      <%if(events.length > 0){%>
      <table class="centered-table">
      <tbody>
        <tr>
          <%while(counter < 5 && counter < events.length){%>
            <td>
              <a class="nav-link" href="/event?id=<%-events[counter].id-%>" method="GET" id=<%-events[counter].id-%>>
              <div class="card">
                <img src="<%-events[counter].performers[0].image-%>" class="card-img-top" alt="https://gamepedia.cursecdn.com/lolesports_gamepedia_en/thumb/c/c0/University_of_Colorado_Boulderlogo_square.png/1200px-University_of_Colorado_Boulderlogo_square.png" width = "100" height = "100">
                <div class="card-body">
                  <h5 class="card-title"><%-events[counter].performers[0].name-%></h5>
                  <p class="card-text"><%-events[counter].venue.name-%><br><%-events[counter].venue.display_location-%></p>
                </div>

                <%date0 = new Date(events[counter].datetime_utc);%>

                      <%date0 = date0.toString();%>
                      <%myDate0 = "";%>
                      <%counter1 = 0;%>
                      <%for (var i = 0; i < date0.length; i++)
                      {
                        if (counter1 < 3){
                          if (date0[i] == ' ')
                          {
                            counter1++;

                            if (counter1 == 32)
                            {                                     
                              myDate0 += ", ";
                            }
                            else
                            {
                              myDate0 += ' ';
                            }
                          }
                          else
                          {
                            myDate0 += date0[i];
                          }
                        }
                        else break;
                      }%>

                <ul class="list-group list-group-flush">   
          
          
                  <li class="list-group-item"><%-myDate0-%></li>
                  <li class="list-group-item"><%-events[counter].venue.capacity-%>p Capacity</li>
          
                </ul>
                <div class="card-body">
                  <a href="<%-events[counter].performers[0].url-%>" class="card-link">Purchase <%-events[counter].performers[0].name-%> Tickets</a>
                </div>
              </div>
            </div>
            </a>
            </td>
            <%counter++%>
          <%}%>
        </tr>
        <tr>
          <%while(counter < 10 && counter < events.length){%>
            <td>
              <a class="nav-link" href="/event?id=<%-events[counter].id-%>" method="GET" id="<%-events[counter].id-%>">
              <div class="card">
                <img src="<%-events[counter].performers[0].image-%>" class="card-img-top" alt="https://gamepedia.cursecdn.com/lolesports_gamepedia_en/thumb/c/c0/University_of_Colorado_Boulderlogo_square.png/1200px-University_of_Colorado_Boulderlogo_square.png" width = "100" height = "100">
                <div class="card-body">
                  <h5 class="card-title"><%-events[counter].performers[0].name-%></h5>
                  <p class="card-text"><%-events[counter].venue.name-%><br><%-events[counter].venue.display_location-%></p>
                </div>

                <%date1 = new Date(events[counter].datetime_utc);%>

                      <%date1 = date1.toString();%>
                      <%myDate1 = "";%>
                      <%counter1 = 0;%>
                      <%for (var i = 0; i < date1.length; i++)
                      {
                        if (counter1 < 3){
                          if (date1[i] == ' ')
                          {
                            counter1++;

                            if (counter1 == 32)
                            {                                     
                              myDate1 += ", ";
                            }
                            else
                            {
                              myDate1 += ' ';
                            }
                          }
                          else
                          {
                            myDate1 += date1[i];
                          }
                        }
                        else break;
                      }%>
                <ul class="list-group list-group-flush">   
          
                  <li class="list-group-item"><%-myDate1-%></li>
                  <li class="list-group-item"><%-events[counter].venue.capacity-%>p Capacity</li>
          
                </ul>
                <div class="card-body">
                  <a href="<%-events[counter].performers[0].url-%>" class="card-link">Purchase <%-events[counter].performers[0].name-%> Tickets</a>
                </div>
              </div>
            </div>
            </a>
            </td>
            <%counter++%>
          <%}%>
        </tr>
      </tbody>
    </table>
      <%}%>
    </div>
</main>
<% include('../partials/footer') %>

<script>
  function adjustTitleFontSize() {
      const cardTitles = document.querySelectorAll('.card-title');

      cardTitles.forEach(cardTitle => {
          const length = cardTitle.textContent.length;
          const cardBody = cardTitle.closest('.card-body');
          const availableWidth = cardBody.clientWidth; // Available width within the card body
          const defaultFontSize = 3; // Default font size for shorter text

          // Calculate font size based on available width and text length
          const calculatedFontSize = Math.min(availableWidth / (length * 5), defaultFontSize);

          cardTitle.style.fontSize = `${calculatedFontSize}em`; // Set the calculated font size
      });
  }

  window.addEventListener('load', adjustTitleFontSize);
  window.addEventListener('resize', adjustTitleFontSize);
</script>